package com.vm.vulndb.controller;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.vm.vulndb.dto.AllDataResponseDTO;
import com.vm.vulndb.service.VulnerabilityService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/vulnerability")
public class VulnerabilityController {

    @Autowired
    private VulnerabilityService vulnerabilityService;

    /* @PostMapping(value = "/")
    public ResponseEntity getAllVulnerabilityData(@RequestBody int recent) throws JsonProcessingException {
        AllDataResponseDTO result = vulnerabilityService.getAllVulnerabilityData(recent);
        return new ResponseEntity<>(result, HttpStatus.OK);
    }*/
    @PostMapping(path="/",
                consumes = MediaType.APPLICATION_FORM_URLENCODED_VALUE)
    public ResponseEntity getAllVulnerabilityData(int recent) throws JsonProcessingException {
        AllDataResponseDTO result = vulnerabilityService.getAllVulnerabilityData(recent);
        return new ResponseEntity<>(result, HttpStatus.OK);
    }
}
